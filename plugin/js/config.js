/*! For license information please see config.js.LICENSE.txt */
(()=>{var t={230:t=>{t.exports={}},82:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isSecretItem=e.FieldType=void 0,function(t){t[t.Dropdown=0]="Dropdown",t[t.Dropdown_FieldSelect=1]="Dropdown_FieldSelect",t[t.Radio=2]="Radio",t[t.Text=3]="Text",t[t.Number=4]="Number",t[t.MultilineText=5]="MultilineText",t[t.Checkbox=6]="Checkbox",t[t.IncrementalTable=7]="IncrementalTable",t[t.Label=8]="Label",t[t.Separator=9]="Separator"}(e.FieldType||(e.FieldType={})),e.isSecretItem=function(t){return"secret"in t}},518:(t,e,n)=>{"use strict";function i(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.ConfigBuilder=void 0,n(754);const o=n(796),r=n(787),s=n(82),l=n(505),a=n(128);class c{constructor(t,e){i(this,"props",void 0),i(this,"layout",void 0),i(this,"config",void 0),i(this,"field_builder",void 0),this.props=t,this.config=e,this.field_builder=new l.FieldBuilder(t)}static is_layout_info(t){return!!c.LAYOUT_PARTS.includes(t)}static is_includes_layout_info(t){return t.reduce(((t,e)=>(c.is_layout_info(e)&&(t=!0),t)),!1)}build_incremental_table(t,e){const n=new a.IncrementalTableBuilder(t,e,this.field_builder).build(),i=t.table_cols.map((t=>{const e=o.Utils.createElement("span","title");e.textContent=t.header;return o.Utils.createElement("th","kintoneplugin-table-th",[e])}));i.push(o.Utils.createElement("th","kintoneplugin-table-th-blankspace"));const r=o.Utils.createElement("tr","",i),s=o.Utils.createElement("thead","",[r]),l=o.Utils.createElement("tbody","",n);return o.Utils.createElement("table","kintoneplugin-table ms-0",[s,l],"",{id:"table-".concat(t.code)})}static get_grand_tr(t){if(null==t)throw"ERROR: nullが渡されたため祖父要素を取得できません";const e=t,n=null==e?void 0:e.parentNode;return null==n?void 0:n.parentNode}static get_formparts(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n={};for(const i in t){if(!t.hasOwnProperty(i))continue;const o=t[i],r=o.label,s=o.code,l=o.type;e.includes(l)&&(n[s]={code:s,label:r,option:l})}const i=Object.keys(n).map((t=>({key:t,value:n[t]}))).sort(((t,e)=>t.value.label.toString().toLowerCase()<e.value.label.toString().toLowerCase()?-1:t>e?1:0));return Object.assign({},...i.map((t=>({[t.key]:t.value}))))}static addOnChangeEvent(t){for(const e of t)e.addEventListener("change",(t=>{const e=t.target;if(null==e)return;const n=e[e.selectedIndex];let i=n.getAttribute("option");null==i&&(i="");let o=n.getAttribute("code");null==o&&(o="");const r=e.closest("tr");if(null==r)return;const s=r.getElementsByTagName("input");s[0].value=i,s[1].value=o}))}build_fields_dropdown(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const l=o.Utils.createElement("select","select-kintone-field");if(l.id=i,null!=r){const t=o.Utils.createElement("option");t.label=r,l.appendChild(t)}const a=c.get_formparts(t,e);return this.field_builder.compose_fielditems(a,n,s).forEach((t=>{l.appendChild(t)})),o.Utils.createElement("div","",[o.Utils.createElement("div","kintoneplugin-select-outer",[o.Utils.createElement("div","kintoneplugin-select",[l])])])}async build_fields_dropdown_other_app(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(null==t||t==r.ConfigUtilities.DEFAULT_OPTION){const t=o.Utils.createElement("select","select-kintone-field");if(t.id=i,null!=s){const e=o.Utils.createElement("option");e.label=s,t.appendChild(e)}return o.Utils.createElement("div","",[o.Utils.createElement("div","kintoneplugin-select-outer",[o.Utils.createElement("div","kintoneplugin-select",[t])])])}const l=await kintone.api("/k/v1/app/form/fields","GET",{app:parseInt(t)});return this.build_fields_dropdown(l.properties,e,n,i,s)}static make_parts_block(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const l=o.Utils.buildElement({tagName:"div",className:"mb-3",innerHTML:n}),a=o.Utils.buildElement({tagName:"div",className:"h4 mb-2",textContent:e});if(r){const t=o.Utils.buildElement({tagName:"span",className:"text-danger",textContent:"*"});a.appendChild(t)}if(s){const t=o.Utils.buildElement({tagName:"span",className:"badge bg-secondary rounded-pill ms-2",textContent:"secret"});a.appendChild(t)}return o.Utils.buildElement({tagName:"div",className:i+" ms-4 mt-4",childElements:[a,l,t]})}static addFieldSelectEvent(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;kintone.api("/k/v1/app/form/fields","GET",{app:n}).then((n=>{var r,s;const l=Object.keys(n.properties).map((t=>n.properties[t])).filter((t=>"SINGLE_LINE_TEXT"==t.type)).map((t=>({code:t.code,label:t.label,option:t.type}))).map((t=>{const e=o.Utils.createElement("option","");return e.label=t.label,e.setAttribute("code",t.code),e.setAttribute("option",t.option),t.code==i&&e.setAttribute("selected",""),e})),a=o.Utils.createElement("select","select-kintone-field",l);a.addEventListener("change",(t=>{var n;const i=t.target;if(null==i)return;const o=i[i.selectedIndex],r=c(o);null===(n=e.firstChild)||void 0===n||n.remove(),e.appendChild(r)}));const c=t=>{let e;t?(e=t.getAttribute("code"),null==e&&(e="")):e="";const n=o.Utils.createElement("input","kintoneplugin-input-text",[]);n.setAttribute("value",e),n.setAttribute("disabled","");return o.Utils.createElement("td","kintoneplugin-table-td-control",[o.Utils.createElement("div","kintoneplugin-table-td-control-value",[o.Utils.createElement("div","kintoneplugin-input-outer",[n])])])},d=o.Utils.createElement("div","kintoneplugin-table-td-control-value",[o.Utils.createElement("div","kintoneplugin-select-outer",[o.Utils.createElement("div","kintoneplugin-select",[a])])]);null===(r=t.firstChild)||void 0===r||r.remove(),t.appendChild(d),null===(s=e.firstChild)||void 0===s||s.remove();const u=a.item(a.selectedIndex),h=c(u);e.appendChild(h)}))}static set_switch_event(t,e,n){t.querySelectorAll('input[type="radio"]').forEach((t=>{t.addEventListener(e,n)}))}make_string_block(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";if(null==this.config||null==this.props)throw new Error("インスタンスが初期化されていません");const n=t.code,i=this.get_saved_value(this.config,t),r="".concat(e,"-").concat(n),l=o.Utils.createElement("div","kintoneplugin-input-outer",[o.Utils.ce("input","kintoneplugin-input-text",[],"",{type:e,id:r,value:i})]),a="required"in(d=t)&&1==d.required;var d;const u=(t=>!!(0,s.isSecretItem)(t)&&("secret"in t&&1==t.secret))(t);return c.make_parts_block(l,t.label,t.desc,"",a,u)}get_saved_value(t,e){if((0,s.isSecretItem)(e)){const t=kintone.plugin.app.getProxyConfig(e.URL,e.method);if(null==t)return"";let n=e.header;"Authorization Bearer"==n&&(n="Authorization");const i=e.data;if(null!=n){const e=t.headers[n];if(e.startsWith("Bearer")){return e.split(/ /)[1]}return e}if(null!=i)return t.data[i];throw new Error("get_saved_value(): 秘匿情報フィールドとして格納されている情報が不正です。(".concat(t,")"))}let n=t[e.code];return null==n&&(n=null!=e.default?e.default:""),n}make_multiline_block(t){if(null==this.config||null==this.props)throw new Error("インスタンスが初期化されていません");const e=t.code;let n=this.config[e];null==n&&(n=null!=t.default?t.default:"");const i="multiline-".concat(e),r=t.cols?t.cols.toString():"60",s=t.rows?t.rows.toString():"10",l=o.Utils.createElement("div","kintoneplugin-input-outer",[o.Utils.ce("textarea","",[],n,{id:i,rows:s,cols:r})]),a="required"in(d=t)&&1==d.required;var d;return c.make_parts_block(l,t.label,t.desc,"",a)}make_checkbox_block(t){if(null==this.config||null==this.props)throw new Error("インスタンスが初期化されていません");if(null==t||null==t.accept)throw new Error("ConfigBuidler.make_checkbox_block(): 必要なプロパティ accept が未定義です。設定を見直してください。");const e=t.code;let n=this.config[e];null==n&&(n=[]);const i="".concat(e),r=t.accept.map((t=>{const e="".concat(i,"-").concat(t),r={type:"checkbox",name:"checkbox",value:t,id:e};return n.includes(t)&&(r.checked="checked"),o.Utils.createElement("div","kintoneplugin-input-checkbox",[o.Utils.ce("span","kintoneplugin-input-checkbox-item",[o.Utils.ce("input","kintoneplugin-input-checkbox-item",[],"",r),o.Utils.ce("label","",[],t,{for:e})])])})),s="required"in(l=t)&&1==l.required;var l;return c.make_parts_block(o.Utils.ce("div","",r,"",{id:i}),t.label,t.desc,"",s)}make_radio_block(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(null==this.config||null==this.props)throw new Error("インスタンスが初期化されていません");const n=t.code;let i=this.config[n];if(null==i&&null!=t.default&&(i=t.default),null==t||null==t.accept)throw new Error("ConfigBuidler.make_dropdown_fieldselect_block(): 必要なプロパティ accept が未定義です。設定を見直してください。");const r=t.accept.map((t=>{const e="radio-".concat(n,"-").concat(t),r="radio-".concat(n),s=o.Utils.createElement("input");s.setAttribute("type","radio"),s.setAttribute("name",r),s.setAttribute("value",t),s.setAttribute("id",e),t==i&&s.setAttribute("checked","checked");const l=o.Utils.createElement("label","",[],t);return l.setAttribute("for",e),o.Utils.createElement("span","kintoneplugin-input-radio-item",[s,l])})),s=o.Utils.createElement("div","kintoneplugin-input-radio",r);s.id=n;const l="required"in(a=t)&&1==a.required;var a;return c.make_parts_block(s,t.label,t.desc,e,l)}make_dropdown_fieldselect_block(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=[],i=[];if(null==t.accept)throw new Error("ConfigBuidler.make_dropdown_fieldselect_block(): 必要なプロパティ accept が未定義です。設定を見直してください。");if(t.accept.forEach((t=>{c.is_layout_info(t)?i.push(t):n.push(t)})),null==this.config||null==this.props)throw new Error("インスタンスが初期化されていません");if(i.length>0&&null==this.layout)throw new Error("レイアウト情報をロードしていません。load_layout_info() を事前に呼び出してください。");if(i.length>0&&n.length>0)throw new Error("フォーム情報のフィールドとレイアウト情報のフィールドとが混在したドロップダウンは構築できません。");const o=t.code,r=this.config[o];let s;const l=!!t.verbose&&t.verbose;if(n.length>0)s=this.build_fields_dropdown(this.props,n,r,o,t.default,l);else{if(!(i.length>0))throw new Error("[".concat(t.label,"] フォーム情報またはレイアウト情報が空欄で呼び出されました"));s=this.build_fields_dropdown(this.layout,i,r,o,t.default,l)}const a="required"in(d=t)&&1==d.required;var d;return c.make_parts_block(s,t.label,t.desc,e,a)}make_incremental_table_block(t){if(null==this.config||null==this.props)throw new Error("インスタンスが初期化されていません");const e=t.code,n=this.config[e],i=this.build_incremental_table(t,n);return c.make_parts_block(i,t.label,t.desc)}make_subtitle_block(t){const e=o.Utils.ce("div","display-6 mb-3",[],t.label),n=o.Utils.ce("div","ms-4 mt-2 mb-5",[],t.desc);return o.Utils.createElement("div","",[e,n])}async load_layout_info(){const t=(await kintone.api("/k/v1/preview/app/form/layout","GET",{app:kintone.app.getId()})).layout.reduce(((t,e)=>{if("GROUP"==e.type){const n=e.layout.reduce(((t,e)=>{const n=e.fields.filter((t=>"SPACER"==t.type));return t=t.concat(n)}),[]);t.concat(n)}else t=t.concat(e.fields.filter((t=>"SPACER"==t.type)));return t}),[]);this.layout=t.reduce(((t,e)=>(e.code=e.elementId,e.label=e.elementId,t[e.code]=e,t)),{})}}i(c,"LAYOUT_PARTS",["SPACER"]),e.ConfigBuilder=c},716:(t,e,n)=>{"use strict";function i(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.ConfigManager=void 0,n(754);const o=n(787),r=n(518),s=n(82),l=n(796);e.ConfigManager=class{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;i(this,"KEY_CONFIG","config"),i(this,"setting_input",void 0),i(this,"config",{}),i(this,"hooks",{});const o=kintone.plugin.app.getConfig(t);this.set_config(o),this.setting_input=e,n&&this.set_preference(n)}set_preference(t){const e=document.getElementById("plugin_title");e&&(e.textContent=t.title);const n=document.getElementById("plugin_description");n&&(n.textContent=t.description)}build(){kintone.api("/k/v1/preview/app/form/fields","GET",{app:kintone.app.getId()}).then((async t=>{const e=this.make_setting_fields(t.properties),n=this.make_button_submit(),i=this.make_button_cancel(),o=(async()=>{const t=l.Utils.createElement("form","",await e);return t.id="form_settings",t})(),r=document.getElementById("config_body");null==r||r.appendChild(await o);const s=l.Utils.createElement("div","mt-5",[i,n]);null==r||r.appendChild(s)})).then((t=>{this.call_target_event("load")})).catch((t=>{throw t}))}async call_target_event(t){const e=this.hooks[t];if(null!=e)for(const t of e)null!=t&&await t()}layout_inputs(t,e){return e.map((e=>this.make_paragraph(t,e)))}make_paragraph(t,e){switch(e.type){case s.FieldType.Text:return t.make_string_block(e);case s.FieldType.MultilineText:return t.make_multiline_block(e);case s.FieldType.Radio:return t.make_radio_block(e);case s.FieldType.Number:return t.make_string_block(e,"number");case s.FieldType.Checkbox:return t.make_checkbox_block(e);case s.FieldType.IncrementalTable:return t.make_incremental_table_block(e);case s.FieldType.Label:return t.make_subtitle_block(e);case s.FieldType.Separator:return l.Utils.createElement("div","mt-5 bg-info");case s.FieldType.Dropdown_FieldSelect:if(!("accept"in e))throw new Error("プロパティ accept が必要です。config/settings.ts の設定を見直してください。");return t.make_dropdown_fieldselect_block(e);default:throw new Error("未実装のFieldTypeを要求しています。".concat(e.type," を実装してください。"))}}set_config(t){const e=l.Utils.get_from(t,this.KEY_CONFIG,"");""==e||(this.config=JSON.parse(e))}get_config(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(null==t)return this.config;if(t in this.config)return this.config[t];throw new Error("未定義または未設定の設定キーが指定されました: [".concat(t,"]"))}async make_setting_fields(t){const e=new r.ConfigBuilder(t,this.config);return await e.load_layout_info(),this.layout_inputs(e,this.setting_input)}isSecretItem(t){return"secret"in t}secret_parameters(t){const e=this.setting_input.filter((t=>(0,s.isSecretItem)(t)));return this.make_proxy_params(e,t)}make_proxy_params(t,e){const n=t.reduce(((t,e)=>{const n=e.method+":"+e.URL;return null==t[n]&&(t[n]=[]),t[n].push(e),t}),{}),i=Object.keys(n).reduce(((t,i)=>{const o=n[i],r=t=>{const n=e.get_text_value(t.code);if("required"in t||(t.required=!1),1==t.required&&(null==n||null==n||""==n))throw new Error("必須の項目[".concat(t.label,"]が未記入です。"));return null==n||null==n?"":n},s=o.filter((t=>"header"in t)).reduce(((t,e)=>{const n=r(e);if(null==e.header)throw new Error("秘匿設定のheader要素が未定義です。");return"Authorization Bearer"==e.header?t.Authorization="Bearer "+n:t[e.header]=n,t}),{}),l=o.filter((t=>"data"in t)).reduce(((t,e)=>{const n=r(e);if(null==e.data)throw new Error("秘匿設定のdata要素が未定義です");return t[e.data]=n,t}),{}),a={URL:o[0].URL,method:o[0].method,headers:s,data:l};return t.push(a),t}),[]);return i}store_parameters(t){const e={};return this.setting_input.forEach((n=>{if(n.type==s.FieldType.Label||n.type==s.FieldType.Separator)return;if("secret"in n&&1==n.secret)return;const i=n.code,o=n.required,r=t.get_selected(i,n.type);if(r)e[i]=r;else{if(o){const t="必須の設定項目 [".concat(n.label,"] が未設定です(").concat(i,")");throw new Error(t)}e[i]=""}})),e}make_button_submit(){const t=l.Utils.createElement("button","kintoneplugin-button-dialog-ok");return t.setAttribute("type","button"),t.textContent="適用",t.addEventListener("keydown",(t=>{if(t.isComposing||"Enter"==t.code)return!1})),t.addEventListener("click",(async t=>{t.preventDefault();const e=document.getElementById("form_settings");if(null==e)throw"ERROR: フォーム要素を取得できませんでした。";await this.call_target_event("submit").catch((t=>{const e="⛔ 設定の保存でエラーが発生しました。（".concat(t,"）");throw alert(e),new Error(e)}));const n=new o.ConfigUtilities(e);let i,r;try{i=this.secret_parameters(n)}catch(e){const n="⛔ 設定値の保存でエラーが発生しました。設定値を見直してください。（".concat(e,"）");return alert(n),t}i.forEach((async t=>{kintone.plugin.app.setProxyConfig(t.URL,t.method,t.headers,t.data,(()=>{}))}));try{r=this.store_parameters(n),setTimeout((()=>{const t=JSON.stringify(r),e={};e[this.KEY_CONFIG]=t,kintone.plugin.app.setConfig(e)}),200)}catch(e){return alert("⛔ 設定値の保存でエラーが発生しました。設定値を見直してください。（".concat(e,"）")),t}})),t}make_button_cancel(){const t=l.Utils.createElement("button","js-cancel-button kintoneplugin-button-dialog-cancel");return t.textContent="キャンセル",t.addEventListener("click",(function(t){window.location.href="../../"+kintone.app.getId()+"/plugin/"})),t}add_hook(t,e){var n;null==this.hooks[t]&&(this.hooks[t]=[]),null===(n=this.hooks[t])||void 0===n||n.push(e)}}},787:(t,e,n)=>{"use strict";function i(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.ConfigUtilities=void 0;const o=n(796),r=n(82);class s{constructor(t){i(this,"config_form",void 0),i(this,"whole_selected_field_codes",void 0),i(this,"add_selected_field_codes",(t=>{this.whole_selected_field_codes.push(t)})),i(this,"get_selected_fieldcode",(t=>{const e=document.getElementById(t);if(-1==e.selectedIndex)return"";if(e.options[e.selectedIndex].label==s.DEFAULT_OPTION)return"";const n=e.selectedOptions[0].getAttribute("fieldcode");if(null==n)throw new Error("ノード[ ".concat(t," ]はフィールド選択ではありません。"));return n})),i(this,"get_selected_label",(t=>{const e=document.getElementById(t);if(null==e)throw new Error("ConfigUtilities.get_selected_label(): 指定のID'".concat(t,"'が null でした。"));return-1==e.selectedIndex?"":e.selectedOptions[0].label})),i(this,"get_checked_boxes",(t=>{const e=document.querySelectorAll('[id^="'.concat(t,'-"]'));if(0==e.length)throw new Error("ConfigUtilities.get_checked_boxes(): 指定のID'".concat(t,"-'から始まるチェックボックスが見つかりませんでした。"));return Array.from(e).reduce(((t,e)=>(e.checked&&t.push(e.value),t)),[])})),this.config_form=t,this.whole_selected_field_codes=[]}is_overlapped(t){return o.Utils.is_overlapped(this.overlapped(t))}overlapped(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return null!=t&&this.whole_selected_field_codes.concat(t),o.Utils.overlapped(this.whole_selected_field_codes)}clear_selected_field_labels(){this.whole_selected_field_codes=[]}get_selected_radio(t){const e="radio-".concat(t),n=document.getElementsByName(e),i=n.length;for(let t=0;t<i;t++){const e=n[t];if(1==e.checked)return e.value}return""}get_text_value(t){const e="text-".concat(t);return document.getElementById(e).value}get_multilinetext_value(t){const e="multiline-".concat(t);return document.getElementById(e).value}get_number_value(t){const e="number-".concat(t);return document.getElementById(e).value}get_incremental_table_values(t){const e="table-".concat(t),n=document.getElementById(e);if(null==n)throw new Error("指定したテーブルが見つかりません。(id: ".concat(e,")"));return this.abstruct_from_incremental_table(n)}abstruct_from_incremental_table(t){const e=Array.from(t.rows).filter((t=>{var e;return"TH"==(null===(e=t.firstChild)||void 0===e?void 0:e.nodeName)})).map((t=>Array.from(t.cells).filter((t=>""!=t.innerText)).map((t=>t.innerText)))),n=Array.from(t.rows).filter((t=>{var e;return"TH"!=(null===(e=t.firstChild)||void 0===e?void 0:e.nodeName)})).map((t=>Array.from(t.cells).filter((t=>{const e=t.getElementsByClassName("kintoneplugin-input-text")[0],n=t.getElementsByClassName("select-kintone-field")[0],i=t.getElementsByClassName("kintoneplugin-input-checkbox-item"),o=t.getElementsByClassName("kintoneplugin-multiline-text-inner")[0];return void 0!==e||void 0!==n||void 0!==i||null!=o})).map((e=>{const n=e.getElementsByClassName("kintoneplugin-input-text")[0];if(null!=n)return n.value;const i=e.getElementsByClassName("kintoneplugin-multiline-text-inner")[0];if(null!=i)return i.value;const o=e.getElementsByClassName("select-kintone-field")[0];if(null!=o){const t=o.selectedIndex,e=o[t];if("fieldcode"in o[t].attributes){const t=e.getAttribute("fieldcode");if(null!=t)return t}return o[t].label}const r=e.getElementsByClassName("kintoneplugin-input-checkbox");if(null!=r)return Array.from(r).filter((t=>t.childNodes[0].childNodes[0].checked)).map((t=>{if(null==t.textContent)throw new Error("ラベルのないチェックボックスが定義されています。");return t.textContent}));throw new Error("未対応のテーブルセル ".concat(t," が渡されました。"))})).filter((t=>!(Array.isArray(t)&&0==t.length)))));if(0==n.filter((t=>t.length>0)).filter((t=>t.filter((t=>(null!=t?t.length:0)>0)).length>0)).length)return null;const i=e[0];return n.map((t=>t.reduce(((t,e,n)=>{const o=null==e?"":e;return t[i[n]]=o,t}),{})))}get_selected(t,e){switch(e){case r.FieldType.Dropdown:return this.get_selected_label(t);case r.FieldType.Checkbox:return this.get_checked_boxes(t);case r.FieldType.Radio:return this.get_selected_radio(t);case r.FieldType.Dropdown_FieldSelect:return this.get_selected_fieldcode(t);case r.FieldType.Text:return this.get_text_value(t);case r.FieldType.Number:return this.get_number_value(t);case r.FieldType.MultilineText:return this.get_multilinetext_value(t);case r.FieldType.IncrementalTable:return this.get_incremental_table_values(t)}throw new Error("get_selected(): 不明なフィールドタイプが渡されました (field_type: ".concat(e,")"))}}i(s,"DEFAULT_OPTION","----"),e.ConfigUtilities=s},505:(t,e,n)=>{"use strict";function i(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.FieldBuilder=void 0;const o=n(796),r=n(82),s=n(518),l=n(787);e.FieldBuilder=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.ConfigUtilities.DEFAULT_OPTION;i(this,"props",void 0),i(this,"empty_label",void 0),i(this,"build_textcell",(t=>(t=void 0===t?"":t,o.Utils.createElement("div","kintoneplugin-input-outer",[o.Utils.createElement("input","kintoneplugin-input-text",[],void 0,{type:"text",value:t,size:"4"})])))),i(this,"build_checkbox_cell",((t,e,n,i)=>{const r=e.accept.map((e=>{const r="".concat(n,"-").concat(i,"-").concat(e),s=(t=void 0===t?[]:t).includes(e)?"checked":"",l=o.Utils.ce("input","",[],"",{type:"checkbox",name:"checkbox",value:e,id:r});return""!=s&&l.setAttribute("checked",s),o.Utils.ce("div","kintoneplugin-input-checkbox",[o.Utils.createElement("span","kintoneplugin-input-checkbox-item",[l,o.Utils.ce("label","",[],e,{for:r})])])}));return o.Utils.createElement("div","",r)})),i(this,"build_dropdown_cell",((t,e)=>{if(null==e||!("accept"in e))throw new Error("選択肢情報としてundefinedが渡されました。");t=void 0===t?"":t;const n=o.Utils.createElement("select","select-kintone-field");if(null!=e.empty_label){const t=o.Utils.createElement("option");t.label=e.empty_label,n.appendChild(t)}return e.accept.forEach((e=>{const i=o.Utils.createElement("option");i.label=e,e==t&&i.setAttribute("selected",""),n.appendChild(i)})),o.Utils.createElement("div","",[o.Utils.createElement("div","kintoneplugin-select-outer",[o.Utils.createElement("div","kintoneplugin-select",[n])])])})),i(this,"build_dropdown_fieldselect_cell",((t,e)=>{if(null==e||!("accept"in e))throw new Error("選択肢情報としてundefinedが渡されました。");const n=o.Utils.createElement("select","select-kintone-field");n.id=void 0===t?"":t;const i=o.Utils.createElement("option");i.label=this.empty_label,n.appendChild(i);const r=s.ConfigBuilder.get_formparts(this.props,e.accept),l=!!e.verbose&&e.verbose;return this.compose_fielditems(r,t,l).forEach((t=>{n.appendChild(t)})),o.Utils.createElement("div","",[o.Utils.createElement("div","kintoneplugin-select-outer",[o.Utils.createElement("div","kintoneplugin-select",[n])])])})),i(this,"build_multilinetext_cell",(t=>(t=void 0===t?"":t,o.Utils.createElement("div","kintoneplugin-input-outer",[o.Utils.ce("textarea","kintoneplugin-multiline-text-inner",[],t,{rows:"3",cols:"40"})])))),this.props=t,this.empty_label=e}build_table_cell(t,e,n,i){if("accept"in e)switch(e.type){case r.FieldType.Checkbox:return this.build_checkbox_cell(n,e,t,i);case r.FieldType.Dropdown:return this.build_dropdown_cell(n,e);case r.FieldType.Dropdown_FieldSelect:return this.build_dropdown_fieldselect_cell(n,e)}else switch(e.type){case r.FieldType.Text:return this.build_textcell(n);case r.FieldType.MultilineText:return this.build_multilinetext_cell(n,e)}throw new Error("未定義のFieldTypeが渡されました。FieldTypeに".concat(e.type," を実装してください。"))}compose_fielditems(t,e,n){const i=[];for(const r in t){const s=o.Utils.createElement("option"),l=t[r];s.setAttribute("fieldcode",r),s.label=n?l.label+" [".concat(r,"]"):l.label,r==e&&s.setAttribute("selected",""),i.push(s)}return i}}},128:(t,e,n)=>{"use strict";function i(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.IncrementalTableBuilder=void 0;const o=n(796),r=n(518);e.IncrementalTableBuilder=class{constructor(t,e,n){i(this,"table_conf",void 0),i(this,"saved_rows",void 0),i(this,"table_rows",void 0),i(this,"field_builder",void 0),i(this,"rows_count",void 0),this.table_conf=t,this.saved_rows=e,this.field_builder=n,this.table_rows=[],this.rows_count=0}build(){const t=this.table_conf.table_cols,e=t.length-3;return null==this.saved_rows||0==Object.keys(this.saved_rows).length?this.table_rows.push(this.build_table_row(0,t,void 0,e)):this.saved_rows.forEach(((n,i)=>{const o=this.build_table_row(i,t,n,e);this.table_rows.push(o)})),this.table_rows}build_table_row(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const r=[];for(let i=0;i<e.length;i++){const s=e[i],l=null==n?void 0:n[s.header],a=this.field_builder.build_table_cell(this.table_conf.code,s,l,t);r.push(o.Utils.ce("td","",[o.Utils.ce("div","kintoneplugin-table-td-control",[o.Utils.ce("div","kintoneplugin-table-td-control-value",[a])])]))}const s=this.create_button_row_add(e),l=this.create_button_row_remove();i=i<0?0:i;const a=[...Array(i)].map((()=>o.Utils.createElement("td","td_spacer"))),c=[...r,...a,o.Utils.createElement("td","kintoneplugin-table-td-operation",[s,l])];this.rows_count=r.length;return o.Utils.createElement("tr","",c)}get_table_rows_count(){const t="table-".concat(this.table_conf.code),e=document.getElementById(t);if(e)return e.getElementsByTagName("tr").length;throw new Error("指定したテーブルID ".concat(t," が存在しません。"))}create_button_row_add(t){const e=document.createElement("button");return e.className="kintoneplugin-button-add-row-image",e.setAttribute("type","button"),e.setAttribute("title","Add row"),e.addEventListener("click",(e=>{const n=r.ConfigBuilder.get_grand_tr(e.target),i=null==n?void 0:n.parentNode;if(null==n||null==i)throw"ERROR: 祖先のtbodyを取得できませんでした。";if(null==(null==e?void 0:e.target))return;const o=n.children.length-1-t.length,s=this.get_table_rows_count()+1,l=this.build_table_row(s,t,void 0,o);i.insertBefore(l,n.nextElementSibling)})),e}create_button_row_remove(){const t=document.createElement("button");return t.className="kintoneplugin-button-remove-row-image",t.setAttribute("type","button"),t.setAttribute("title","Delete this row"),t.addEventListener("click",(t=>{var e,n;const i=r.ConfigBuilder.get_grand_tr(t.target);1!=(null===(e=i.parentNode)||void 0===e?void 0:e.childNodes.length)&&(null===(n=i.parentNode)||void 0===n||n.removeChild(i))})),t}}},580:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(518),e),o(n(716),e),o(n(787),e),o(n(505),e),o(n(128),e),o(n(82),e)},295:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ButtonInstaller=void 0;const i=n(503);n(230);e.ButtonInstaller=class{class_hms_button="button-hms-items";buttons=[];canvas;constructor(t=""){""!=t&&(this.class_hms_button=t)}create_button(t,e=""){const n=i.Utils.ce("span","",[],t);n.style.color="dodgerblue";let o=i.Utils.ce("button",this.class_hms_button,[n],"",{title:e});return o=i.Utils.decorate_menu_icon(o),t.length>2&&(o.style.fontSize="16px"),o}add_button(t){this.buttons.push(t)}install(){this.already_installed()||0!=this.buttons.length&&this.put_buttons(this.buttons)}set_canvas(t){this.canvas=t}get_hms(){const t=kintone.app.getHeaderMenuSpaceElement();if(null==t){throw new Error("ボタン配置スペースが取得できませんでした。")}return t}already_installed(){return document.getElementsByClassName(this.class_hms_button).length>0}put_buttons(t){const e=void 0===this.canvas?this.get_hms():this.canvas;t.forEach((t=>{e.append(t)}))}get_header_element(t){const e=document.querySelectorAll(".recordlist-header-label-gaia");return Array.from(e).filter((e=>e.textContent==t))}}},231:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(503),e),o(n(295),e),o(n(456),e)},456:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PluginCanvas=void 0;const i=n(503);n(230);class o{static CLASS_DISMISS="offcanvas-dismiss";id_island;id_offcanvas;title_offcanvas;island;enable_offcanvas;constructor(t,e,n=null,o){if(this.title_offcanvas=t,this.id_island=`plugin_island_id_${e}`,this.id_offcanvas=`offcanvas_${this.id_island}`,""==e){if(null==n&&(n=kintone.app.getHeaderMenuSpaceElement()),null==n)throw new Error("kintone.app.HeaderMenuSpaceElement() を取得できませんでした。");return this.island=n,void(this.enable_offcanvas=!1)}this.enable_offcanvas=!0;const r=document.getElementById(this.id_island);if(r)this.island=r;else{const t=(t=>{if(t)return t;{const t=i.Utils.ce("span","",[],"🎈");return t.style.cursor="pointer",t}})(o);t.style.color="dodgerblue";let e=i.Utils.ce("div","bbk-tool-icon-box",[t],"",{id:this.id_island,"data-bs-toggle":"offcanvas","aria-controls":this.id_offcanvas,"data-bs-target":`#${this.id_offcanvas}`});e=i.Utils.decorate_menu_icon(e),this.island=e,this.init_offcanvas()}}init_offcanvas(){const t=kintone.app.getHeaderMenuSpaceElement();t&&(t.appendChild(this.get_node()),t.appendChild(this.build_node_offcanvas()))}get_node(){return this.island}build_node_offcanvas(){return i.Utils.ce("div","offcanvas offcanvas-start",[i.Utils.ce("div","offcanvas-header",[i.Utils.ce("h5","offcanvas-title",[],this.title_offcanvas,{id:`${this.id_offcanvas}Label`}),i.Utils.ce("button","btn-close text-reset",[],"",{"data-bs-dismiss":"offcanvas","aria-label":"Close"})]),i.Utils.ce("div","offcanvas-body",[i.Utils.ce("div","mb-4",[],"ここから各種プラグインを呼び出せます。")],"",{id:`${this.id_offcanvas}-body`})],"",{tabindex:"-1",id:`${this.id_offcanvas}`,"aria-labelledby":`${this.id_offcanvas}Label`,"data-bs-backdrop":"false"})}append(t){if(this.enable_offcanvas){const e=document.getElementById(`${this.id_offcanvas}-body`);this.deal_dismiss_attribute(t),e?.appendChild(t)}else this.island.append(t)}deal_dismiss_attribute(t){const e=Array.from(t.querySelectorAll(`.${o.CLASS_DISMISS}`));e.length>0?e.map((t=>{t.setAttribute("data-bs-dismiss","offcanvas")})):t.setAttribute("data-bs-dismiss","offcanvas")}}e.PluginCanvas=o},503:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Utils=void 0;class n{static unique_properties(t,e=!1){const n=[];for(const i of Object.keys(t)){const o=t[i];(1==o.unique||e&&"RECORD_NUMBER"==o.type)&&n.push(o)}return n}static is_not_empty_string(t){return!n.is_empty_string(t)}static is_empty_string(t){return null==t||null==t||!(t.length>0)}static get_from=(t,e,n)=>t.hasOwnProperty(e)?t[e]:n;static buildElement=t=>{const e=t.tagName,i=t.className?t.className:"",o=t.childElements?t.childElements:[],r=t.textContent?t.textContent:void 0,s=t.innerHTML?t.innerHTML:void 0,l=t.attrs?t.attrs:{};return n.createElement(e,i,o,r,l,s)};static createElement=(t,e="",n=[],i,o,r)=>{const s=document.createElement(t);return s.className=e,null!=i&&(s.textContent=i),null!=r&&(s.innerHTML=r),n.length>0&&n.forEach((t=>{s.appendChild(t)})),o&&Object.entries(o).forEach((([t,e])=>{s.setAttribute(t,e)})),s};static ce=(t,e="",n=[],i="",o)=>this.createElement(t,e,n,i,o);static decorate_menu_icon(t){return t.style.height="48px",t.style.backgroundColor="#f7f9fa",t.style.fontSize="28px",t.style.border="1px solid #e3e7e8",t.style.display="inline",t.style.marginLeft="2px",t.style.marginRight="2px",t.style.verticalAlign="middle",t}static simpleDiv=t=>n.createElement("div","",[],t);static is_overlapped=t=>n.overlapped(t).length>0;static overlapped=t=>{const e=t.filter(((t,e,n)=>n.indexOf(t)!==n.lastIndexOf(t)));return Array.from(new Set(e))};static get_application_url(t){return`${location.protocol}//${location.host}/k/${t}`}static retrieve_errors(t,e=-1){const n=t?.error?.errors;if(null==n)return;let i=[];if(Object.keys(n).forEach((t=>{const e=n[t].messages.map((e=>`[${t}] ${e}`));i=i.concat(e)})),i.sort(),e>=0&&e<i.length){const t=i.length-e;i=i.splice(0,e),i.push(`以下${t}件のエラーメッセージを省略しました。`)}return i}}e.Utils=n},754:t=>{t.exports={}},715:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ButtonInstaller=void 0;const i=n(177);n(754);e.ButtonInstaller=class{class_hms_button="button-hms-items";buttons=[];canvas;constructor(t=""){""!=t&&(this.class_hms_button=t)}create_button(t,e=""){const n=i.Utils.ce("span","",[],t);n.style.color="dodgerblue";let o=i.Utils.ce("button",this.class_hms_button,[n],"",{title:e});return o=i.Utils.decorate_menu_icon(o),t.length>2&&(o.style.fontSize="16px"),o}add_button(t){this.buttons.push(t)}install(){this.already_installed()||0!=this.buttons.length&&this.put_buttons(this.buttons)}set_canvas(t){this.canvas=t}get_hms(){const t=kintone.app.getHeaderMenuSpaceElement();if(null==t){throw new Error("ボタン配置スペースが取得できませんでした。")}return t}already_installed(){return document.getElementsByClassName(this.class_hms_button).length>0}put_buttons(t){const e=void 0===this.canvas?this.get_hms():this.canvas;t.forEach((t=>{e.append(t)}))}get_header_element(t){const e=document.querySelectorAll(".recordlist-header-label-gaia");return Array.from(e).filter((e=>e.textContent==t))}}},796:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(177),e),o(n(715),e),o(n(23),e)},23:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PluginCanvas=void 0;const i=n(177);n(754);class o{static CLASS_DISMISS="offcanvas-dismiss";id_island;id_offcanvas;title_offcanvas;island;enable_offcanvas;constructor(t,e,n=null,o){if(this.title_offcanvas=t,this.id_island=`plugin_island_id_${e}`,this.id_offcanvas=`offcanvas_${this.id_island}`,""==e){if(null==n&&(n=kintone.app.getHeaderMenuSpaceElement()),null==n)throw new Error("kintone.app.HeaderMenuSpaceElement() を取得できませんでした。");return this.island=n,void(this.enable_offcanvas=!1)}this.enable_offcanvas=!0;const r=document.getElementById(this.id_island);if(r)this.island=r;else{const t=(t=>{if(t)return t;{const t=i.Utils.ce("span","",[],"🎈");return t.style.cursor="pointer",t}})(o);t.style.color="dodgerblue";let e=i.Utils.ce("div","bbk-tool-icon-box",[t],"",{id:this.id_island,"data-bs-toggle":"offcanvas","aria-controls":this.id_offcanvas,"data-bs-target":`#${this.id_offcanvas}`});e=i.Utils.decorate_menu_icon(e),this.island=e,this.init_offcanvas()}}init_offcanvas(){const t=kintone.app.getHeaderMenuSpaceElement();t&&(t.appendChild(this.get_node()),t.appendChild(this.build_node_offcanvas()))}get_node(){return this.island}build_node_offcanvas(){return i.Utils.ce("div","offcanvas offcanvas-start",[i.Utils.ce("div","offcanvas-header",[i.Utils.ce("h5","offcanvas-title",[],this.title_offcanvas,{id:`${this.id_offcanvas}Label`}),i.Utils.ce("button","btn-close text-reset",[],"",{"data-bs-dismiss":"offcanvas","aria-label":"Close"})]),i.Utils.ce("div","offcanvas-body",[i.Utils.ce("div","mb-4",[],"ここから各種プラグインを呼び出せます。")],"",{id:`${this.id_offcanvas}-body`})],"",{tabindex:"-1",id:`${this.id_offcanvas}`,"aria-labelledby":`${this.id_offcanvas}Label`,"data-bs-backdrop":"false"})}append(t){if(this.enable_offcanvas){const e=document.getElementById(`${this.id_offcanvas}-body`);this.deal_dismiss_attribute(t),e?.appendChild(t)}else this.island.append(t)}deal_dismiss_attribute(t){const e=Array.from(t.querySelectorAll(`.${o.CLASS_DISMISS}`));e.length>0?e.map((t=>{t.setAttribute("data-bs-dismiss","offcanvas")})):t.setAttribute("data-bs-dismiss","offcanvas")}}e.PluginCanvas=o},177:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Utils=void 0;class n{static unique_properties(t,e=!1){const n=[];for(const i of Object.keys(t)){const o=t[i];(1==o.unique||e&&"RECORD_NUMBER"==o.type)&&n.push(o)}return n}static is_not_empty_string(t){return!n.is_empty_string(t)}static is_empty_string(t){return null==t||null==t||!(t.length>0)}static get_from=(t,e,n)=>t.hasOwnProperty(e)?t[e]:n;static buildElement=t=>{const e=t.tagName,i=t.className?t.className:"",o=t.childElements?t.childElements:[],r=t.textContent?t.textContent:void 0,s=t.innerHTML?t.innerHTML:void 0,l=t.attrs?t.attrs:{};return n.createElement(e,i,o,r,l,s)};static createElement=(t,e="",n=[],i,o,r)=>{const s=document.createElement(t);return s.className=e,null!=i&&(s.textContent=i),null!=r&&(s.innerHTML=r),n.length>0&&n.forEach((t=>{s.appendChild(t)})),o&&Object.entries(o).forEach((([t,e])=>{s.setAttribute(t,e)})),s};static ce=(t,e="",n=[],i="",o)=>this.createElement(t,e,n,i,o);static decorate_menu_icon(t){return t.style.height="48px",t.style.backgroundColor="#f7f9fa",t.style.fontSize="28px",t.style.border="1px solid #e3e7e8",t.style.display="inline",t.style.marginLeft="2px",t.style.marginRight="2px",t.style.verticalAlign="middle",t}static simpleDiv=t=>n.createElement("div","",[],t);static is_overlapped=t=>n.overlapped(t).length>0;static overlapped=t=>{const e=t.filter(((t,e,n)=>n.indexOf(t)!==n.lastIndexOf(t)));return Array.from(new Set(e))};static get_application_url(t){return`${location.protocol}//${location.host}/k/${t}`}static retrieve_errors(t,e=-1){const n=t?.error?.errors;if(null==n)return;let i=[];if(Object.keys(n).forEach((t=>{const e=n[t].messages.map((e=>`[${t}] ${e}`));i=i.concat(e)})),i.sort(),e>=0&&e<i.length){const t=i.length-e;i=i.splice(0,e),i.push(`以下${t}件のエラーメッセージを省略しました。`)}return i}}e.Utils=n}},e={};function n(i){var o=e[i];if(void 0!==o)return o.exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,n),r.exports}(()=>{"use strict";var t=n(580);const e={PLUGIN_NAME:"ChatGPT連携プラグイン",EMPTY_LABEL:"----",API_KEY:"api_key",MODEL_ID:"model_id",STATIC_PROMPT:"static_prompt",UNIQUE_PROMPT:"unique_prompt",INPUT_FIELD:"input_field",OUTPUT_FIELD:"output_field",BTN_SPACE_FIELD:"btn_space_field",FLAG_RECORD_MODIFIER:"flag_record_modifier",LABELS_RECORD_MODIFIER:["enable","disable"],NUMBER_MAX_TOKENS:"NUMBER_MAX_TOKENS",SYSTEM_PROMPT:"system_prompt",TABLE_FEWSHOTS_PROMPT:"table_fewshot_prompt",TABLE_FEWSHOTS:{role:"役割",content:"プロンプト"}};function i(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class o{}i(o,"preference",{title:"ChatGPT連携プラグインの設定",description:""}),i(o,"input",[{label:"ChatGPTの設定",desc:"API呼び出しに必要な項目を指定します。",type:t.FieldType.Label},{label:"API Key",desc:"ChatGPT APIのAPI Tokenを指定してください。",code:e.API_KEY,type:t.FieldType.Text,required:!0,secret:!0,URL:"https://api.openai.com/v1/chat/completions",method:"POST",header:"Authorization Bearer"},{label:"ChatGPTの利用モデル",desc:'利用モデル名を入力してください。デフォルトは "gpt-3.5-turbo" です。',code:e.MODEL_ID,type:t.FieldType.Text,default:"gpt-3.5-turbo",required:!0},{label:"MAX Tokens",desc:"レスポンスの最大トークン長を指定してください。",code:e.NUMBER_MAX_TOKENS,type:t.FieldType.Number,default:"512",required:!0},{label:"役割プロンプト",desc:"ChatGPTの役割を与えます。あなたはカウンセラーです。のような役割をプロンプトしてください。",code:e.SYSTEM_PROMPT,type:t.FieldType.MultilineText,rows:3,cols:50,required:!1},{label:"対話例プロンプト",desc:"会話の例をChatGPTに教えます。この項目が長くなる場合はMAX Tokensの値を増やしてください。",code:e.TABLE_FEWSHOTS_PROMPT,type:t.FieldType.IncrementalTable,required:!1,table_cols:[{header:e.TABLE_FEWSHOTS.role,type:t.FieldType.Dropdown,accept:["user","assistant"]},{header:e.TABLE_FEWSHOTS.content,type:t.FieldType.MultilineText}]},{label:"",desc:"==============================================",type:t.FieldType.Separator,required:!1},{label:"プラグインの動作設定",desc:"ボタンの配置やレコード単位でプロンプトとして使用するフィールドなどを設定します。",type:t.FieldType.Label},{label:"実行ボタン配置スペース選択",desc:"API呼び出しを実行するボタンを配置するスペースを選択してください。",code:e.BTN_SPACE_FIELD,type:t.FieldType.Dropdown_FieldSelect,accept:["SPACER"],required:!0},{label:"[danger] レコード編集モード",desc:"有効にするとレコード全体を編集対象として書き換えるモードで動作します。その際、↓以降の設定は無効になります。よくわからない場合はdisableにしておいてください。",code:e.FLAG_RECORD_MODIFIER,type:t.FieldType.Radio,accept:e.LABELS_RECORD_MODIFIER,default:e.LABELS_RECORD_MODIFIER[1],required:!0},{label:"",desc:"==============================================",type:t.FieldType.Separator,required:!1},{label:"kintoneのフィールド設定",desc:"ChatGPTに問い合わせる入力フィールドと、回答を出力する出力フィールドを設定します。",type:t.FieldType.Label},{label:"入力フィールド選択",desc:"入力として使用するフィールドを選択してください",code:e.INPUT_FIELD,type:t.FieldType.Dropdown_FieldSelect,accept:["SINGLE_LINE_TEXT","MULTI_LINE_TEXT"],required:!0},{label:"出力フィールド選択",desc:"ChatGPTの返答を入力するフィールドを選択してください。",code:e.OUTPUT_FIELD,type:t.FieldType.Dropdown_FieldSelect,accept:["MULTI_LINE_TEXT"],required:!0}]);const r=window,s=r.ShadowRoot&&(void 0===r.ShadyCSS||r.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,l=Symbol(),a=new WeakMap;class c{constructor(t,e,n){if(this._$cssResult$=!0,n!==l)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(s&&void 0===t){const n=void 0!==e&&1===e.length;n&&(t=a.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),n&&a.set(e,t))}return t}toString(){return this.cssText}}const d=s?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e="";for(const n of t.cssRules)e+=n.cssText;return(t=>new c("string"==typeof t?t:t+"",void 0,l))(e)})(t):t;var u;const h=window,p=h.trustedTypes,_=p?p.emptyScript:"",f=h.reactiveElementPolyfillSupport,b={toAttribute(t,e){switch(e){case Boolean:t=t?_:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=null!==t;break;case Number:n=null===t?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch(t){n=null}}return n}},m=(t,e)=>e!==t&&(e==e||t==t),v={attribute:!0,type:String,converter:b,reflect:!1,hasChanged:m};class g extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(t){var e;this.finalize(),(null!==(e=this.h)&&void 0!==e?e:this.h=[]).push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach(((e,n)=>{const i=this._$Ep(n,e);void 0!==i&&(this._$Ev.set(i,n),t.push(i))})),t}static createProperty(t,e=v){if(e.state&&(e.attribute=!1),this.finalize(),this.elementProperties.set(t,e),!e.noAccessor&&!this.prototype.hasOwnProperty(t)){const n="symbol"==typeof t?Symbol():"__"+t,i=this.getPropertyDescriptor(t,n,e);void 0!==i&&Object.defineProperty(this.prototype,t,i)}}static getPropertyDescriptor(t,e,n){return{get(){return this[e]},set(i){const o=this[t];this[e]=i,this.requestUpdate(t,o,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||v}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),void 0!==t.h&&(this.h=[...t.h]),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const t=this.properties,e=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(const n of e)this.createProperty(n,t[n])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const n=new Set(t.flat(1/0).reverse());for(const t of n)e.unshift(d(t))}else void 0!==t&&e.push(d(t));return e}static _$Ep(t,e){const n=e.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof t?t.toLowerCase():void 0}u(){var t;this._$E_=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(t=this.constructor.h)||void 0===t||t.forEach((t=>t(this)))}addController(t){var e,n;(null!==(e=this._$ES)&&void 0!==e?e:this._$ES=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(n=t.hostConnected)||void 0===n||n.call(t))}removeController(t){var e;null===(e=this._$ES)||void 0===e||e.splice(this._$ES.indexOf(t)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((t,e)=>{this.hasOwnProperty(e)&&(this._$Ei.set(e,this[e]),delete this[e])}))}createRenderRoot(){var t;const e=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return((t,e)=>{s?t.adoptedStyleSheets=e.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):e.forEach((e=>{const n=document.createElement("style"),i=r.litNonce;void 0!==i&&n.setAttribute("nonce",i),n.textContent=e.cssText,t.appendChild(n)}))})(e,this.constructor.elementStyles),e}connectedCallback(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostConnected)||void 0===e?void 0:e.call(t)}))}enableUpdating(t){}disconnectedCallback(){var t;null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostDisconnected)||void 0===e?void 0:e.call(t)}))}attributeChangedCallback(t,e,n){this._$AK(t,n)}_$EO(t,e,n=v){var i;const o=this.constructor._$Ep(t,n);if(void 0!==o&&!0===n.reflect){const r=(void 0!==(null===(i=n.converter)||void 0===i?void 0:i.toAttribute)?n.converter:b).toAttribute(e,n.type);this._$El=t,null==r?this.removeAttribute(o):this.setAttribute(o,r),this._$El=null}}_$AK(t,e){var n;const i=this.constructor,o=i._$Ev.get(t);if(void 0!==o&&this._$El!==o){const t=i.getPropertyOptions(o),r="function"==typeof t.converter?{fromAttribute:t.converter}:void 0!==(null===(n=t.converter)||void 0===n?void 0:n.fromAttribute)?t.converter:b;this._$El=o,this[o]=r.fromAttribute(e,t.type),this._$El=null}}requestUpdate(t,e,n){let i=!0;void 0!==t&&(((n=n||this.constructor.getPropertyOptions(t)).hasChanged||m)(this[t],e)?(this._$AL.has(t)||this._$AL.set(t,e),!0===n.reflect&&this._$El!==t&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(t,n))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((t,e)=>this[e]=t)),this._$Ei=void 0);let e=!1;const n=this._$AL;try{e=this.shouldUpdate(n),e?(this.willUpdate(n),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostUpdate)||void 0===e?void 0:e.call(t)})),this.update(n)):this._$Ek()}catch(t){throw e=!1,this._$Ek(),t}e&&this._$AE(n)}willUpdate(t){}_$AE(t){var e;null===(e=this._$ES)||void 0===e||e.forEach((t=>{var e;return null===(e=t.hostUpdated)||void 0===e?void 0:e.call(t)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(t){return!0}update(t){void 0!==this._$EC&&(this._$EC.forEach(((t,e)=>this._$EO(e,this[e],t))),this._$EC=void 0),this._$Ek()}updated(t){}firstUpdated(t){}}var y;g.finalized=!0,g.elementProperties=new Map,g.elementStyles=[],g.shadowRootOptions={mode:"open"},null==f||f({ReactiveElement:g}),(null!==(u=h.reactiveElementVersions)&&void 0!==u?u:h.reactiveElementVersions=[]).push("1.6.1");const E=window,k=E.trustedTypes,w=k?k.createPolicy("lit-html",{createHTML:t=>t}):void 0,A=`lit$${(Math.random()+"").slice(9)}$`,T="?"+A,$=`<${T}>`,S=document,U=(t="")=>S.createComment(t),C=t=>null===t||"object"!=typeof t&&"function"!=typeof t,x=Array.isArray,O=t=>x(t)||"function"==typeof(null==t?void 0:t[Symbol.iterator]),N=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,P=/-->/g,I=/>/g,L=RegExp(">|[ \t\n\f\r](?:([^\\s\"'>=/]+)([ \t\n\f\r]*=[ \t\n\f\r]*(?:[^ \t\n\f\r\"'`<>=]|(\"|')|))|$)","g"),M=/'/g,B=/"/g,R=/^(?:script|style|textarea|title)$/i,F=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),D=F(1),j=(F(2),Symbol.for("lit-noChange")),H=Symbol.for("lit-nothing"),q=new WeakMap,z=S.createTreeWalker(S,129,null,!1),G=(t,e)=>{const n=t.length-1,i=[];let o,r=2===e?"<svg>":"",s=N;for(let e=0;e<n;e++){const n=t[e];let l,a,c=-1,d=0;for(;d<n.length&&(s.lastIndex=d,a=s.exec(n),null!==a);)d=s.lastIndex,s===N?"!--"===a[1]?s=P:void 0!==a[1]?s=I:void 0!==a[2]?(R.test(a[2])&&(o=RegExp("</"+a[2],"g")),s=L):void 0!==a[3]&&(s=L):s===L?">"===a[0]?(s=null!=o?o:N,c=-1):void 0===a[1]?c=-2:(c=s.lastIndex-a[2].length,l=a[1],s=void 0===a[3]?L:'"'===a[3]?B:M):s===B||s===M?s=L:s===P||s===I?s=N:(s=L,o=void 0);const u=s===L&&t[e+1].startsWith("/>")?" ":"";r+=s===N?n+$:c>=0?(i.push(l),n.slice(0,c)+"$lit$"+n.slice(c)+A+u):n+A+(-2===c?(i.push(void 0),e):u)}const l=r+(t[n]||"<?>")+(2===e?"</svg>":"");if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==w?w.createHTML(l):l,i]};class W{constructor({strings:t,_$litType$:e},n){let i;this.parts=[];let o=0,r=0;const s=t.length-1,l=this.parts,[a,c]=G(t,e);if(this.el=W.createElement(a,n),z.currentNode=this.el.content,2===e){const t=this.el.content,e=t.firstChild;e.remove(),t.append(...e.childNodes)}for(;null!==(i=z.nextNode())&&l.length<s;){if(1===i.nodeType){if(i.hasAttributes()){const t=[];for(const e of i.getAttributeNames())if(e.endsWith("$lit$")||e.startsWith(A)){const n=c[r++];if(t.push(e),void 0!==n){const t=i.getAttribute(n.toLowerCase()+"$lit$").split(A),e=/([.?@])?(.*)/.exec(n);l.push({type:1,index:o,name:e[2],strings:t,ctor:"."===e[1]?V:"?"===e[1]?Q:"@"===e[1]?tt:J})}else l.push({type:6,index:o})}for(const e of t)i.removeAttribute(e)}if(R.test(i.tagName)){const t=i.textContent.split(A),e=t.length-1;if(e>0){i.textContent=k?k.emptyScript:"";for(let n=0;n<e;n++)i.append(t[n],U()),z.nextNode(),l.push({type:2,index:++o});i.append(t[e],U())}}}else if(8===i.nodeType)if(i.data===T)l.push({type:2,index:o});else{let t=-1;for(;-1!==(t=i.data.indexOf(A,t+1));)l.push({type:7,index:o}),t+=A.length-1}o++}}static createElement(t,e){const n=S.createElement("template");return n.innerHTML=t,n}}function K(t,e,n=t,i){var o,r,s,l;if(e===j)return e;let a=void 0!==i?null===(o=n._$Co)||void 0===o?void 0:o[i]:n._$Cl;const c=C(e)?void 0:e._$litDirective$;return(null==a?void 0:a.constructor)!==c&&(null===(r=null==a?void 0:a._$AO)||void 0===r||r.call(a,!1),void 0===c?a=void 0:(a=new c(t),a._$AT(t,n,i)),void 0!==i?(null!==(s=(l=n)._$Co)&&void 0!==s?s:l._$Co=[])[i]=a:n._$Cl=a),void 0!==a&&(e=K(t,a._$AS(t,e.values),a,i)),e}class X{constructor(t,e){this.u=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}v(t){var e;const{el:{content:n},parts:i}=this._$AD,o=(null!==(e=null==t?void 0:t.creationScope)&&void 0!==e?e:S).importNode(n,!0);z.currentNode=o;let r=z.nextNode(),s=0,l=0,a=i[0];for(;void 0!==a;){if(s===a.index){let e;2===a.type?e=new Y(r,r.nextSibling,this,t):1===a.type?e=new a.ctor(r,a.name,a.strings,this,t):6===a.type&&(e=new et(r,this,t)),this.u.push(e),a=i[++l]}s!==(null==a?void 0:a.index)&&(r=z.nextNode(),s++)}return o}p(t){let e=0;for(const n of this.u)void 0!==n&&(void 0!==n.strings?(n._$AI(t,n,e),e+=n.strings.length-2):n._$AI(t[e])),e++}}class Y{constructor(t,e,n,i){var o;this.type=2,this._$AH=H,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=n,this.options=i,this._$Cm=null===(o=null==i?void 0:i.isConnected)||void 0===o||o}get _$AU(){var t,e;return null!==(e=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==e?e:this._$Cm}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===t.nodeType&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=K(this,t,e),C(t)?t===H||null==t||""===t?(this._$AH!==H&&this._$AR(),this._$AH=H):t!==this._$AH&&t!==j&&this.g(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):O(t)?this.k(t):this.g(t)}O(t,e=this._$AB){return this._$AA.parentNode.insertBefore(t,e)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}g(t){this._$AH!==H&&C(this._$AH)?this._$AA.nextSibling.data=t:this.T(S.createTextNode(t)),this._$AH=t}$(t){var e;const{values:n,_$litType$:i}=t,o="number"==typeof i?this._$AC(t):(void 0===i.el&&(i.el=W.createElement(i.h,this.options)),i);if((null===(e=this._$AH)||void 0===e?void 0:e._$AD)===o)this._$AH.p(n);else{const t=new X(o,this),e=t.v(this.options);t.p(n),this.T(e),this._$AH=t}}_$AC(t){let e=q.get(t.strings);return void 0===e&&q.set(t.strings,e=new W(t)),e}k(t){x(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let n,i=0;for(const o of t)i===e.length?e.push(n=new Y(this.O(U()),this.O(U()),this,this.options)):n=e[i],n._$AI(o),i++;i<e.length&&(this._$AR(n&&n._$AB.nextSibling,i),e.length=i)}_$AR(t=this._$AA.nextSibling,e){var n;for(null===(n=this._$AP)||void 0===n||n.call(this,!1,!0,e);t&&t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){var e;void 0===this._$AM&&(this._$Cm=t,null===(e=this._$AP)||void 0===e||e.call(this,t))}}class J{constructor(t,e,n,i,o){this.type=1,this._$AH=H,this._$AN=void 0,this.element=t,this.name=e,this._$AM=i,this.options=o,n.length>2||""!==n[0]||""!==n[1]?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=H}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,e=this,n,i){const o=this.strings;let r=!1;if(void 0===o)t=K(this,t,e,0),r=!C(t)||t!==this._$AH&&t!==j,r&&(this._$AH=t);else{const i=t;let s,l;for(t=o[0],s=0;s<o.length-1;s++)l=K(this,i[n+s],e,s),l===j&&(l=this._$AH[s]),r||(r=!C(l)||l!==this._$AH[s]),l===H?t=H:t!==H&&(t+=(null!=l?l:"")+o[s+1]),this._$AH[s]=l}r&&!i&&this.j(t)}j(t){t===H?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:"")}}class V extends J{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===H?void 0:t}}const Z=k?k.emptyScript:"";class Q extends J{constructor(){super(...arguments),this.type=4}j(t){t&&t!==H?this.element.setAttribute(this.name,Z):this.element.removeAttribute(this.name)}}class tt extends J{constructor(t,e,n,i,o){super(t,e,n,i,o),this.type=5}_$AI(t,e=this){var n;if((t=null!==(n=K(this,t,e,0))&&void 0!==n?n:H)===j)return;const i=this._$AH,o=t===H&&i!==H||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,r=t!==H&&(i===H||o);o&&this.element.removeEventListener(this.name,this,i),r&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var e,n;"function"==typeof this._$AH?this._$AH.call(null!==(n=null===(e=this.options)||void 0===e?void 0:e.host)&&void 0!==n?n:this.element,t):this._$AH.handleEvent(t)}}class et{constructor(t,e,n){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(t){K(this,t)}}const nt=E.litHtmlPolyfillSupport;null==nt||nt(W,Y),(null!==(y=E.litHtmlVersions)&&void 0!==y?y:E.litHtmlVersions=[]).push("2.6.1");var it,ot;class rt extends g{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t,e;const n=super.createRenderRoot();return null!==(t=(e=this.renderOptions).renderBefore)&&void 0!==t||(e.renderBefore=n.firstChild),n}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=((t,e,n)=>{var i,o;const r=null!==(i=null==n?void 0:n.renderBefore)&&void 0!==i?i:e;let s=r._$litPart$;if(void 0===s){const t=null!==(o=null==n?void 0:n.renderBefore)&&void 0!==o?o:null;r._$litPart$=s=new Y(e.insertBefore(U(),t),t,void 0,null!=n?n:{})}return s._$AI(t),s})(e,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!1)}render(){return j}}rt.finalized=!0,rt._$litElement$=!0,null===(it=globalThis.litElementHydrateSupport)||void 0===it||it.call(globalThis,{LitElement:rt});const st=globalThis.litElementPolyfillSupport;null==st||st({LitElement:rt});(null!==(ot=globalThis.litElementVersions)&&void 0!==ot?ot:globalThis.litElementVersions=[]).push("3.2.2");const lt=(t,e)=>"method"===e.kind&&e.descriptor&&!("value"in e.descriptor)?{...e,finisher(n){n.createProperty(e.key,t)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:e.key,initializer(){"function"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(n){n.createProperty(e.key,t)}};function at(t){return(e,n)=>void 0!==n?((t,e,n)=>{e.constructor.createProperty(n,t)})(t,e,n):lt(t,e)}var ct;null===(ct=window.HTMLSlotElement)||void 0===ct||ct.prototype.assignedElements;const dt=2;class ut{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,n){this._$Ct=t,this._$AM=e,this._$Ci=n}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}class ht extends ut{constructor(t){if(super(t),this.it=H,t.type!==dt)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(t){if(t===H||null==t)return this._t=void 0,this.it=t;if(t===j)return t;if("string"!=typeof t)throw Error(this.constructor.directiveName+"() called with a non-string value");if(t===this.it)return this._t;this.it=t;const e=[t];return e.raw=e,this._t={_$litType$:this.constructor.resultType,strings:e,values:[]}}}ht.directiveName="unsafeHTML",ht.resultType=1;const pt={fromAttribute:t=>null===t,toAttribute:t=>t?null:""};class _t extends rt{createRenderRoot(){return this}async throwErrorAfterUpdateComplete(t){throw await this.updateComplete,new Error(t)}}var ft=function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};let bt;(()=>{if(bt=window.customElements.get("kuc-button-1-10-0"),!bt){class t extends _t{constructor(t){super(),this.className="",this.id="",this.text="",this.type="normal",this.disabled=!1,this.visible=!0;const e=function(t){if(!t||"object"!=typeof t)return{};const e={...t};for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&void 0===e[t]&&delete e[t];return e}(t);Object.assign(this,e)}_handleClickButton(t){t.stopPropagation(),((t,e,n)=>{const i=new CustomEvent(e,{detail:n,bubbles:!0,composed:!0});t.dispatchEvent(i)})(this,"click")}_getButtonColorType(){return"normal"===this.type||"submit"===this.type||"alert"===this.type?this.type:"normal"}render(){return D`
        <button
          type="button"
          class="kuc-button-1-10-0__button kuc-button-1-10-0__button--${this._getButtonColorType()}"
          ?disabled="${this.disabled}"
          @click="${this._handleClickButton}"
        >
          ${this.text}
        </button>
      `}}ft([at({type:String,reflect:!0,attribute:"class"})],t.prototype,"className",void 0),ft([at({type:String,reflect:!0,attribute:"id"})],t.prototype,"id",void 0),ft([at({type:String})],t.prototype,"text",void 0),ft([at({type:String})],t.prototype,"type",void 0),ft([at({type:Boolean})],t.prototype,"disabled",void 0),ft([at({type:Boolean,attribute:"hidden",reflect:!0,converter:pt})],t.prototype,"visible",void 0),window.customElements.define("kuc-button-1-10-0",t),(t=>{const e=document.createElement("style");e.appendChild(document.createTextNode(t)),document.head.appendChild(e)})('\n  kuc-button-1-10-0,\n  kuc-button-1-10-0 *,\n  kuc-button-1-10-0:lang(en),\n  kuc-button-1-10-0:lang(en) * {\n    font-family: "HelveticaNeueW02-45Ligh", Arial, "Hiragino Kaku Gothic ProN",\n      Meiryo, sans-serif;\n  }\n  kuc-button-1-10-0:lang(ja),\n  kuc-button-1-10-0:lang(ja) * {\n    font-family: "メイリオ", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;\n  }\n  kuc-button-1-10-0:lang(zh),\n  kuc-button-1-10-0:lang(zh) * {\n    font-family: "微软雅黑", "Microsoft YaHei", "新宋体", NSimSun, STHeiti, Hei,\n      "Heiti SC", sans-serif;\n  }\n  kuc-button-1-10-0:lang(zh-TW),\n  kuc-button-1-10-0:lang(zh-TW) * {\n    font-family: "微軟正黑體","Microsoft JhengHei","新宋体",NSimSun,STHeiti,\n      Hei,"Heiti SC",sans-serif;\n  }\n  kuc-button-1-10-0 {\n    display: inline-block;\n    vertical-align: top;\n  }\n  kuc-button-1-10-0[hidden] {\n    display: none;\n  }\n  .kuc-button-1-10-0__button {\n    display: grid;\n    align-items: center;\n    font-size: var(--kuc-button-font-size, 16px);\n    width: var(--kuc-button-width, "auto");\n    height: var(--kuc-button-height, 48px);\n    min-width: var(--kuc-button-width, 163px);\n    padding: 0px 16px;\n    user-select: none;\n    white-space: nowrap;\n  }\n  .kuc-button-1-10-0__button--normal {\n    background-color: var(--kuc-button-background-color, #f7f9fa);\n    color: var(--kuc-button-text-color, #3498db);\n    border: 1px solid #e3e7e8;\n  }\n  .kuc-button-1-10-0__button--normal:hover,\n  .kuc-button-1-10-0__button--normal:focus-visible,\n  .kuc-button-1-10-0__button--normal:active {\n    cursor: pointer;\n  }\n  .kuc-button-1-10-0__button--normal:hover {\n    background-color: var(--kuc-button-background-hover, #c8d6dd);\n  }\n  .kuc-button-1-10-0__button--normal:focus-visible {\n    background-color: var(--kuc-button-background-focus, #c8d6dd);\n  }\n  .kuc-button-1-10-0__button--normal:active {\n    background-color: var(--kuc-button-background-active, #c8d6dd);\n  }\n  .kuc-button-1-10-0__button--submit {\n    background-color: var(--kuc-button-background-color, #3498db);\n    color: var(--kuc-button-text-color, #ffffff);\n    border: 1px solid #e3e7e8;\n  }\n  .kuc-button-1-10-0__button--submit:hover,\n  .kuc-button-1-10-0__button--submit:focus-visible,\n  .kuc-button-1-10-0__button--submit:active {\n    cursor: pointer;\n  }\n  .kuc-button-1-10-0__button--submit:hover {\n    background-color: var(--kuc-button-background-hover, #1d6fa5);\n  }\n  .kuc-button-1-10-0__button--submit:focus-visible {\n    background-color: var(--kuc-button-background-focus, #1d6fa5);\n  }\n  .kuc-button-1-10-0__button--submit:active {\n    background-color: var(--kuc-button-background-active, #1d6fa5);\n  }\n  .kuc-button-1-10-0__button--alert {\n    background-color: var(--kuc-button-background-color, #e74c3c);\n    color: var(--kuc-button-text-color, #ffffff);\n    border: 1px solid #e3e7e8;\n  }\n  .kuc-button-1-10-0__button--alert:hover,\n  .kuc-button-1-10-0__button--alert:focus-visible,\n  .kuc-button-1-10-0__button--alert:active {\n    cursor: pointer;\n  }\n  .kuc-button-1-10-0__button--alert:hover {\n    background-color: var(--kuc-button-background-hover, #bf2718);\n  }\n  .kuc-button-1-10-0__button--alert:focus-visible {\n    background-color: var(--kuc-button-background-focus, #bf2718);\n  }\n  .kuc-button-1-10-0__button--alert:active {\n    background-color: var(--kuc-button-background-active, #bf2718);\n  }\n  .kuc-button-1-10-0__button:disabled {\n    background-color: var(--kuc-button-background-color, #d4d7d7);\n    border: 1px solid #e3e7e8;\n    color: var(--kuc-button-text-color, #888888);\n    cursor: default;\n  }\n  .kuc-button-1-10-0__button--normal:focus-visible,\n  .kuc-button-1-10-0__button--submit:focus-visible,\n  .kuc-button-1-10-0__button--alert:focus-visible {\n    outline: 1px solid #3498db;\n  }\n'),bt=t}})();const mt=bt;var vt=n(231);class gt{LABEL_ITEM="📁 プラグイン設定を保存・復元します";LABEL_IMPORT_BUTTON="⬆️設定をアップロード（復元）";LABEL_EXPORT_BUTTON="⬇️設定をダウンロード（保存）";HEADER_NODE_ID="KINTANLAB-SETTING-IMPORTER";ID_SUBMIT_BUTTON="button-load-settings";DOWNLOAD_FILENAME="settings.json";store_config={};constructor(t){this.plugin_id=t}put_forms(t){null==t&&(t=this.HEADER_NODE_ID);const e=this.compose_export_form(this.plugin_id),n=this.compose_import_form(),i=vt.Utils.buildElement({tagName:"div",className:"container_import_export",childElements:[e,n]}),o=vt.Utils.buildElement({tagName:"div",textContent:this.LABEL_ITEM}),r=vt.Utils.ce("div","",[o]),s=document.getElementById(t);null!=s&&s.appendChild(vt.Utils.ce("div","mt-3 mb-3",[r,i]))}compose_import_form(){const t=this.make_button_import();return vt.Utils.buildElement({tagName:"div",className:"import_form_block",childElements:[t],attrs:{style:"margin-top: 1em;"}})}make_button_import(){const t=new mt({text:this.LABEL_IMPORT_BUTTON,type:"submit",id:this.ID_SUBMIT_BUTTON}),e=vt.Utils.buildElement({tagName:"input",attrs:{type:"file",id:"fileInput",value:this.LABEL_IMPORT_BUTTON}});return t.addEventListener("click",(t=>{e.click()})),e.addEventListener("change",(t=>{this.importSettings(t)})),t}importSettings(t){if(null==t||null==t.target)return;const e=t.target.files[0];if(!e)return;const n=new FileReader;n.onload=t=>{try{if(null==t.target)throw new Error("event.targetにnullが返りました。");if("string"!=typeof t.target.result)throw new Error("event.target.result が文字列型ではありませんでした。");const e=JSON.parse(t.target.result);this.store_config=e;confirm("現在の設定を上書きして、読み込んだ設定を保存します。よろしいですか？")&&kintone.plugin.app.setConfig(this.store_config,(function(){alert("🆙 プラグイン設定を保存しました。アプリの更新をお忘れなく！"),window.location.href="../../flow?app="+kintone.app.getId()}))}catch(t){}},n.readAsText(e)}put_export_link(t){null==t&&(t=this.plugin_id);const e=this.compose_export_form(t),n=document.getElementById(this.HEADER_NODE_ID);if(null==n)throw new Error(`ノード #${this.HEADER_NODE_ID} が見つかりませんでした。`);n.appendChild(e)}compose_export_form(t){const e=kintone.plugin.app.getConfig(t),n=JSON.stringify(e),i=this.make_download_button(n,this.DOWNLOAD_FILENAME);return vt.Utils.ce("div","export_button_block",[i],"",{style:"float: left; margin-right: 1em;"})}make_download_button(t,e="settings.txt"){const n=new Uint8Array([239,187,191]),i=new Blob([n,t],{type:"octet/stream"}),o=vt.Utils.buildElement({tagName:"a",attrs:{href:window.URL.createObjectURL(i),download:e,role:"button"}}),r=new mt({text:this.LABEL_EXPORT_BUTTON,type:"normal"});r.addEventListener("click",(t=>{o.click()}));return vt.Utils.ce("div","",[r])}}!function(e){if(null==e)throw new Error("PLUGIN_ID == undefined で呼び出されました。");const n=o.preference,i=o.input;new t.ConfigManager(e,i,n).build();new gt(e).put_forms("config_body")}(kintone.$PLUGIN_ID)})()})();